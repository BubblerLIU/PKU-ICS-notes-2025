本讲主要内容：

- [[#信息存储]]
- [[#整数表示]]
- [[#整数运算]]

## 信息存储

这一部分只研究存储空间是如何**规划和使用**的，并不涉及具体的某种对象（如整数类型）是如何编码的。并且，我们也不关心存储设备在物理层面上的实现，而只关心其在**逻辑层面**上的抽象，即**虚拟内存和虚拟地址空间**。

### 内存的逻辑抽象

内存的最小单元是bit，它可以是二进制数0或1。然而，大多数计算机的最小寻址单位是由连续的8个bit组成的一个byte，即字节。也就是说，在使用计算机对内存进行定位时，无法**直接**定位到某个具体的bit，而只能定位到某个byte。

在逻辑层面上，人们以byte作为基本单位，将内存抽象为一个由byte组成的数组，称为**虚拟内存**；虚拟内存中的每个字节由一个唯一的数字来标识，称为该字节的**地址**，地址的所有合法取值集合称为**虚拟地址空间**。这就是机器级程序看待内存的方式。

通常，一台计算机用于存放地址的bit位数是一定的，称为这台计算机的**字长**。对于字长为$w$位的计算机而言，虚拟地址的取值范围为$0$~$2^w-1$，即程序最多访问$2^{w}$个字节。

#### 字长对程序的影响

在不同字长的机器上，一些典型数据类型所占用的字节数不同，最典型的就是指针类型。但32位程序和64位程序的区别并不在于它们运行在什么机器上，而是它们**如何编译**的，即编译指令参数的区别。例如，在32位机器上也可以通过指令编译64位程序，但该程序在32位机器上运行时可能产生错误。

### 跨字节对象的存储

有的存储对象需要占用多个字节，但任何对象都只有唯一的地址，那么如何定义多字节对象的地址，又要如何根据它的地址推算其它字节的位置和含义呢？

通常，多字节对象占用**连续的**若干字节存储，以最小地址作为该对象的地址。假设该对象共占用$w$位，从最高有效位到最低有效位表示为$[x_{w-1}, x_{w-2}, \dots, x_{0}]$，且$w$是8的倍数，则该对象能被分为若干字节：最高有效字节为$[x_{w-1}, x_{w-2}, \dots ,x_{w-8}]$，最低有效字节为$[x_{7}, x_{6}, \dots ,x_{0}]$。

对于这些字节的排列顺序，通常有两种规则：

- 大端法：最高有效字节在前；
- 小端法：最低有效字节在前。

**注意**：使用小端法时，仅仅是字节顺序翻转了，字节内bit的顺序不变，不要想当然地直接把二进制或十六进制表示翻转过来！

大端法和小端法并没有优劣之分，只是使用习惯的区别。

#### 字符串的表示

字符串的表示是比较特殊的。通常，一个字符占用一个字节进行存储，字符串由若干字符构成，以'\0'字符结尾。字符串并不作为一个整体受到大小端规则的限制，而总是以字符在**字符串中的先后顺序**存储的。

## 整数表示

这一部分我们研究如何通过二进制bit的编码来表示整数，分为无符号整数编码和补码编码两种不同的编码方式。

### 无符号整数的编码

一个$w$位的无符号整数，我们可以把它的位向量写成$\vec{x}=[x_{w-1}, x_{w-2},\dots,x_{0}]$，所谓“编码”就是建立一个$\vec{x}$和无符号整数之间**一一对应**的关系（双射）。我们这样定义$\vec{x}$对应的无符号整数：
$$
B 2U_{w}(\vec{x})=\sum_{i=0}^{w-1}x_{i}2^{i}
$$
它的表示范围是$[0, 2^{w}-1]$中的整数，下面我们证明映射$B 2U_{w}$是所有$w$位bit向量$\vec{x}$到$[0,2^{w}-1]$中整数的双射。

**证明**：首先证明该映射是单射，设$\vec{x}, \vec{y}$是两个不同的位向量，使$x_{i}\neq y_{i}\ (i=0,1,\dots,w-1)$成立的最大的$i$为$k$，对两向量的像作差得
$$
B 2U_{w}(\vec{x})-B 2U_{w}(\vec{y})=(x_{k}-y_{k})2^{k}+\sum_{i=0}^{k-1}(x_{i}-y_{i})2^{i}
$$
由于$|x_{k}-y_{k}|=1$，而第二项求和的绝对值必定小于等于$2^k-1$，故差值必不为0，映射为单射。

容易发现，该映射的值域和定义域基数均为$2^w$，定义域中的$2^w$个元素必定产生$2^w$个不同的像，故值域中的每个元素都有原像，因此该映射为满射。

综上，映射$B 2U_{w}$是双射。**证毕**。

这样，对于任何在表示范围内的整数，我们都可以把它变成二进制位存储在计算机内；对于任何计算机内存储的二进制位，如果它表示无符号整数，我们也可以还原出该十进制整数。

### 补码编码

当我们想要将表示范围扩展到负整数时，就显然不能再用上面的编码方法了。表示有符号数常用的编码方法为**补码**。

补码编码的定义如下：对于位向量$\vec{x}=[x_{w-1},x_{w-2},\dots,x_{0}]$，定义映射$B 2T_{w}$为
$$
B 2T_{w}(\vec{x})=-x_{w-1}2^{w-1}+\sum_{i=0}^{w-2}x_{i}2^{i}
$$
容易看出，补码编码能够表示的最小值为$TMin_{w}=B 2T_{w}([10\dots 0])=-2^{w-1}$，最大值为$TMax_{w}=B 2T_{w}([01\dots 1])=2^{w-1}-1$，下面我们证明它是双射。

**证明**：
## 整数运算


